src/
  App.jsx
  lib/
    supabaseClient.js
  components/
    Auth.jsx
  features/
    money/
      MoneyApp.jsx




-- Table
create table if not exists public.expenses (
  id uuid primary key default gen_random_uuid(),
  user_id uuid references auth.users(id) on delete cascade,
  amount numeric(12,2) not null check (amount >= 0),
  account text not null check (account in ('gcash','debit card','cash','credit card')),
  category text not null,
  note text,
  created_at timestamptz not null default now()
);
-- Helpful indexes
create index if not exists expenses_created_at_idx on public.expenses(created_at desc);
create index if not exists expenses_user_id_idx on public.expenses(user_id);
-- (Optional but recommended for multi-user security)
-- Enable RLS + attach user automatically
alter table public.expenses enable row level security;
create or replace function public.set_expense_user_id()
returns trigger language plpgsql as $$
begin
  if new.user_id is null then new.user_id := auth.uid(); end if;
  return new;
end $$;
drop trigger if exists trg_set_expense_user_id on public.expenses;
create trigger trg_set_expense_user_id
before insert on public.expenses
for each row execute function public.set_expense_user_id();
-- Policies (users can only see/manage their own rows)
create policy "read own" on public.expenses
  for select using (user_id = auth.uid());
create policy "insert own" on public.expenses
  for insert with check (user_id = auth.uid());
create policy "update own" on public.expenses
  for update using (user_id = auth.uid()) with check (user_id = auth.uid());
create policy "delete own" on public.expenses
  for delete using (user_id = auth.uid());











  | jsonb_pretty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [
    {
        "rls": {
            "rls_forced": false,
            "rls_enabled": true
        },
        "table": "expenses",
        "columns": [
            {
                "name": "id",
                "type": "uuid",
                "default": "gen_random_uuid()",
                "nullable": false,
                "udt_name": "uuid"
            },
            {
                "name": "user_id",
                "type": "uuid",
                "default": null,
                "nullable": true,
                "udt_name": "uuid"
            },
            {
                "name": "amount",
                "type": "numeric",
                "default": null,
                "nullable": false,
                "udt_name": "numeric"
            },
            {
                "name": "account",
                "type": "text",
                "default": null,
                "nullable": false,
                "udt_name": "text"
            },
            {
                "name": "category",
                "type": "text",
                "default": null,
                "nullable": false,
                "udt_name": "text"
            },
            {
                "name": "note",
                "type": "text",
                "default": null,
                "nullable": true,
                "udt_name": "text"
            },
            {
                "name": "created_at",
                "type": "timestamp with time zone",
                "default": "now()",
                "nullable": false,
                "udt_name": "timestamptz"
            }
        ],
        "indexes": [
            {
                "name": "expenses_created_at_idx",
                "definition": "CREATE INDEX expenses_created_at_idx ON public.expenses USING btree (created_at DESC)"
            },
            {
                "name": "expenses_pkey",
                "definition": "CREATE UNIQUE INDEX expenses_pkey ON public.expenses USING btree (id)"
            },
            {
                "name": "expenses_user_id_idx",
                "definition": "CREATE INDEX expenses_user_id_idx ON public.expenses USING btree (user_id)"
            }
        ],
        "policies": [
            {
                "cmd": "DELETE",
                "name": "delete own",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "INSERT",
                "name": "insert own",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": null
            },
            {
                "cmd": "SELECT",
                "name": "read own",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "SELECT",
                "name": "read own or spouse",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "((user_id = auth.uid()) OR (user_id IN ( SELECT spouse_connections.spouse_user_id\n   FROM spouse_connections\n  WHERE (spouse_connections.user_id = auth.uid()))) OR (user_id IN ( SELECT spouse_connections.user_id\n   FROM spouse_connections\n  WHERE (spouse_connections.spouse_user_id = auth.uid()))))"
            },
            {
                "cmd": "UPDATE",
                "name": "update own",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            }
        ],
        "primary_key": [
            "id"
        ],
        "foreign_keys": [
        ]
    },
    {
        "rls": {
            "rls_forced": false,
            "rls_enabled": true
        },
        "table": "incomes",
        "columns": [
            {
                "name": "id",
                "type": "uuid",
                "default": "gen_random_uuid()",
                "nullable": false,
                "udt_name": "uuid"
            },
            {
                "name": "user_id",
                "type": "uuid",
                "default": null,
                "nullable": true,
                "udt_name": "uuid"
            },
            {
                "name": "amount",
                "type": "numeric",
                "default": null,
                "nullable": false,
                "udt_name": "numeric"
            },
            {
                "name": "account",
                "type": "text",
                "default": null,
                "nullable": false,
                "udt_name": "text"
            },
            {
                "name": "category",
                "type": "text",
                "default": null,
                "nullable": false,
                "udt_name": "text"
            },
            {
                "name": "note",
                "type": "text",
                "default": null,
                "nullable": true,
                "udt_name": "text"
            },
            {
                "name": "created_at",
                "type": "timestamp with time zone",
                "default": "now()",
                "nullable": false,
                "udt_name": "timestamptz"
            }
        ],
        "indexes": [
            {
                "name": "incomes_created_at_idx",
                "definition": "CREATE INDEX incomes_created_at_idx ON public.incomes USING btree (created_at DESC)"
            },
            {
                "name": "incomes_pkey",
                "definition": "CREATE UNIQUE INDEX incomes_pkey ON public.incomes USING btree (id)"
            },
            {
                "name": "incomes_user_id_idx",
                "definition": "CREATE INDEX incomes_user_id_idx ON public.incomes USING btree (user_id)"
            }
        ],
        "policies": [
            {
                "cmd": "DELETE",
                "name": "delete own",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "INSERT",
                "name": "insert own",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": null
            },
            {
                "cmd": "SELECT",
                "name": "read own",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "SELECT",
                "name": "read own or spouse",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "((user_id = auth.uid()) OR (user_id IN ( SELECT spouse_connections.spouse_user_id\n   FROM spouse_connections\n  WHERE (spouse_connections.user_id = auth.uid()))) OR (user_id IN ( SELECT spouse_connections.user_id\n   FROM spouse_connections\n  WHERE (spouse_connections.spouse_user_id = auth.uid()))))"
            },
            {
                "cmd": "UPDATE",
                "name": "update own",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            }
        ],
        "primary_key": [
            "id"
        ],
        "foreign_keys": [
        ]
    },
    {
        "rls": {
            "rls_forced": false,
            "rls_enabled": true
        },
        "table": "spouse_connections",
        "columns": [
            {
                "name": "id",
                "type": "uuid",
                "default": "gen_random_uuid()",
                "nullable": false,
                "udt_name": "uuid"
            },
            {
                "name": "user_id",
                "type": "uuid",
                "default": null,
                "nullable": true,
                "udt_name": "uuid"
            },
            {
                "name": "spouse_email",
                "type": "text",
                "default": null,
                "nullable": false,
                "udt_name": "text"
            },
            {
                "name": "spouse_user_id",
                "type": "uuid",
                "default": null,
                "nullable": true,
                "udt_name": "uuid"
            },
            {
                "name": "created_at",
                "type": "timestamp with time zone",
                "default": "now()",
                "nullable": true,
                "udt_name": "timestamptz"
            }
        ],
        "indexes": [
            {
                "name": "spouse_connections_pkey",
                "definition": "CREATE UNIQUE INDEX spouse_connections_pkey ON public.spouse_connections USING btree (id)"
            },
            {
                "name": "unique_user_spouse",
                "definition": "CREATE UNIQUE INDEX unique_user_spouse ON public.spouse_connections USING btree (user_id)"
            }
        ],
        "policies": [
            {
                "cmd": "DELETE",
                "name": "Users can delete their own spouse connections",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "INSERT",
                "name": "Users can insert their own spouse connections",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": null
            },
            {
                "cmd": "UPDATE",
                "name": "Users can update their own spouse connections",
                "check": "(user_id = auth.uid())",
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            },
            {
                "cmd": "SELECT",
                "name": "Users can view their own spouse connections",
                "check": null,
                "roles": [
                    "public"
                ],
                "using": "(user_id = auth.uid())"
            }
        ],
        "primary_key": [
            "id"
        ],
        "foreign_keys": [
        ]
    }
] |